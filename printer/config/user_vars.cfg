[gcode_macro USER_VARIABLES]
description: Load user defined variables
variable_hw: {}
variable_macros: {}
variable_filament: {}
gcode:
    {% set axis_limits = printer.toolhead.axis_maximum %}
    {% set hw_vars = { "default_color" : [0, 0, 255],
                       "volume" : {"x": 300, "y": 300, "z": 280},
                       "case_light_states" : {0 : "OFF", 1 : "ON", 2 : "DIM"}} %}
    {% set macro_vars = {"park_position": {"filament_change": {"x": axis_limits.x//2,
                                                               "y": 20,
                                                               "z": 100},
                                           "bed_clear": {"x": axis_limits.x//2,
                                                         "y": axis_limits.y - 5,
                                                         "z" : [100, printer.toolhead.position.z]|max},
                                           "print_end": {"x": hw_vars.volume.x,
                                                         "y": hw_vars.volume.y}
                                        }} %}
    {% set filament_vars = {"map": {100: "PLA", 200: "ABS", 300: "PETG"},
                            "defaults" : {
                                "pa": {"PLA" : 0.035}
                                },
                            "brands": {}
                            } %}

    SET_GCODE_VARIABLE MACRO=USER_VARIABLES VARIABLE=hw VALUE="{hw_vars}"
    SET_GCODE_VARIABLE MACRO=USER_VARIABLES VARIABLE=macros VALUE="{macro_vars}"
    SET_GCODE_VARIABLE MACRO=USER_VARIABLES VARIABLE=filament VALUE="{filament_vars}"